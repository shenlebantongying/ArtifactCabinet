TODO: union, split, list to tree
